<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Robo-Magnet: Scrapyard</title>
    <style>
        :root { --magnet-blue: #00d2ff; --bomb-red: #ff3e3e; --iron: #bdc3c7; }
        body { margin: 0; overflow: hidden; background: #0f172a; color: white; font-family: 'Courier New', monospace; touch-action: none; }
        
        #hud { position: fixed; top: 20px; width: 100%; display: flex; justify-content: space-around; z-index: 100; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px; border: 1px solid var(--magnet-blue); }

        #robot { 
            position: absolute; width: 60px; height: 60px; font-size: 50px; 
            display: flex; align-items: center; justify-content: center;
            z-index: 50; transition: transform 0.1s;
        }
        
        /* Magnet Wave Effect */
        #magnet-wave {
            position: absolute; border: 3px solid var(--magnet-blue); border-radius: 50%;
            width: 300px; height: 300px; opacity: 0; transform: scale(0.1);
            pointer-events: none; z-index: 40;
        }

        .junk { position: absolute; font-size: 25px; z-index: 30; }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        button { padding: 15px 50px; font-size: 22px; background: var(--magnet-blue); border: none; font-weight: bold; border-radius: 5px; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div id="hud">
    <div class="stat">PARTS: <span id="parts">0</span></div>
    <div class="stat">RC: <span id="rc">0</span></div>
</div>

<div id="start-screen" class="overlay">
    <h1 style="color: var(--magnet-blue);">ROBO-MAGNET</h1>
    <p>1. DRAG to move your robot.<br>2. HOLD to activate MAGNET.<br>3. COLLECT scrap, AVOID bombs!</p>
    <button onclick="startGame()">ACTIVATE SYSTEM</button>
</div>

<div id="robot">ðŸ¤–</div>
<div id="magnet-wave"></div>

<script>
    let parts = 0, rc = 0, gameActive = false, isMagnetOn = false;
    const robot = document.getElementById('robot');
    const wave = document.getElementById('magnet-wave');
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    let items = [];

    function playSound(f, type, dur, vol) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type; osc.frequency.value = f;
        osc.connect(gain); gain.connect(audioCtx.destination);
        gain.gain.setValueAtTime(vol, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur);
        osc.start(); osc.stop(audioCtx.currentTime + dur);
    }

    // Move Robot
    window.onpointermove = (e) => {
        if(!gameActive) return;
        robot.style.left = (e.clientX - 30) + 'px';
        robot.style.top = (e.clientY - 30) + 'px';
        wave.style.left = (e.clientX - 150) + 'px';
        wave.style.top = (e.clientY - 150) + 'px';
    };

    // Magnet Control
    window.onpointerdown = () => { if(gameActive) { isMagnetOn = true; wave.style.opacity = '1'; wave.style.transform = 'scale(1)'; playSound(200, 'sine', 0.5, 0.1); } };
    window.onpointerup = () => { isMagnetOn = false; wave.style.opacity = '0'; wave.style.transform = 'scale(0.1)'; };

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        gameActive = true;
        if(audioCtx.state === 'suspended') audioCtx.resume();
        spawnJunk();
        update();
    }

    function spawnJunk() {
        if(!gameActive) return;
        const item = document.createElement('div');
        const isBomb = Math.random() > 0.8;
        item.className = 'junk';
        item.innerHTML = isBomb ? 'ðŸ’£' : (Math.random() > 0.5 ? 'âš™ï¸' : 'ðŸ”©');
        item.dataset.type = isBomb ? 'bomb' : 'scrap';
        
        item.style.left = Math.random() * window.innerWidth + 'px';
        item.style.top = '-50px';
        document.body.appendChild(item);
        
        items.push({ el: item, y: -50, x: parseFloat(item.style.left) });
        setTimeout(spawnJunk, 600);
    }

    function update() {
        if(!gameActive) return;

        items.forEach((obj, i) => {
            let robotRect = robot.getBoundingClientRect();
            let dx = (robotRect.left + 30) - obj.x;
            let dy = (robotRect.top + 30) - obj.y;
            let dist = Math.hypot(dx, dy);

            // Magnet logic
            if(isMagnetOn && dist < 180) {
                obj.x += dx * 0.15;
                obj.y += dy * 0.15;
            } else {
                obj.y += 3;
            }

            obj.el.style.top = obj.y + 'px';
            obj.el.style.left = obj.x + 'px';

            // Collision
            if(dist < 40) {
                if(obj.el.dataset.type === 'bomb') {
                    gameOver();
                } else {
                    parts++;
                    rc += 10;
                    document.getElementById('parts').innerText = parts;
                    document.getElementById('rc').innerText = rc;
                    playSound(800, 'sine', 0.1, 0.1);
                    obj.el.remove();
                    items.splice(i, 1);
                }
            }

            if(obj.y > window.innerHeight) {
                obj.el.remove();
                items.splice(i, 1);
            }
        });

        requestAnimationFrame(update);
    }

    function gameOver() {
        gameActive = false;
        playSound(100, 'sawtooth', 0.5, 0.2);
        alert(`KABOOM! You pulled a bomb.\nParts Collected: ${parts}\nTotal RC: ${rc}`);
        location.reload();
    }
</script>
</body>
</html>