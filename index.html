<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Robo-Puncher: Arena</title>
    <style>
        :root { --neon-yellow: #faff00; --neon-red: #ff003c; --bg: #0d0d0d; }
        body { margin: 0; overflow: hidden; background: var(--bg); color: white; font-family: 'Arial Black', sans-serif; touch-action: none; }
        
        #arena { position: relative; width: 100vw; height: 100vh; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        
        /* HUD */
        #hud { position: fixed; top: 20px; width: 100%; display: flex; justify-content: space-around; z-index: 100; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.8); padding: 10px 20px; border: 2px solid var(--neon-yellow); border-radius: 5px; }

        /* Player */
        #player { font-size: 80px; z-index: 50; position: relative; transition: transform 0.1s; }
        .punch-left { transform: translateX(-40px) scaleX(-1); }
        .punch-right { transform: translateX(40px); }

        /* Enemy */
        .enemy { position: absolute; font-size: 50px; z-index: 40; transition: left 0.05s, right 0.05s; }

        /* Overlay */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; }
        button { padding: 15px 50px; font-size: 22px; background: var(--neon-yellow); border: none; font-weight: bold; cursor: pointer; border-radius: 5px; margin-top: 20px; }
        
        #flash { position: fixed; inset: 0; background: white; opacity: 0; pointer-events: none; z-index: 999; }
    </style>
</head>
<body>

<div id="hud">
    <div class="stat">SCORE: <span id="score">0</span></div>
    <div class="stat">HP: <span id="hp">100</span>%</div>
</div>

<div id="arena">
    <div id="player">ðŸ¤–</div>
</div>

<div id="flash"></div>

<div id="start-screen" class="overlay">
    <h1 style="color: var(--neon-yellow); font-size: 45px;">ROBO-PUNCHER</h1>
    <p>Tap LEFT side to punch Left<br>Tap RIGHT side to punch Right<br>Don't let them touch you!</p>
    <button onclick="startGame()">START BATTLE</button>
</div>

<script>
    let score = 0, hp = 100, gameActive = false;
    const player = document.getElementById('player');
    const arena = document.getElementById('arena');
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playHitSound(f, d) {
        let osc = audioCtx.createOscillator();
        let gain = audioCtx.createGain();
        osc.type = 'square';
        osc.frequency.setValueAtTime(f, audioCtx.currentTime);
        osc.connect(gain); gain.connect(audioCtx.destination);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + d);
        osc.start(); osc.stop(audioCtx.currentTime + d);
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        gameActive = true;
        if(audioCtx.state === 'suspended') audioCtx.resume();
        spawnEnemy();
        
        // Background Beat
        setInterval(() => {
            if(gameActive) playHitSound(60, 0.2);
        }, 500);
    }

    window.onpointerdown = (e) => {
        if(!gameActive) return;
        const side = e.clientX < window.innerWidth / 2 ? 'left' : 'right';
        
        player.className = side === 'left' ? 'punch-left' : 'punch-right';
        playHitSound(200, 0.1);

        // Check hits
        const enemies = document.querySelectorAll('.enemy');
        enemies.forEach(en => {
            const rect = en.getBoundingClientRect();
            const pRect = player.getBoundingClientRect();
            const dist = Math.abs(rect.left - pRect.left);

            if(dist < 150) {
                if((side === 'left' && rect.left < pRect.left) || 
                   (side === 'right' && rect.left > pRect.left)) {
                    en.innerHTML = 'ðŸ’¥';
                    score += 10;
                    document.getElementById('score').innerText = score;
                    setTimeout(() => en.remove(), 100);
                    playHitSound(400, 0.1);
                }
            }
        });

        setTimeout(() => player.className = '', 100);
    };

    function spawnEnemy() {
        if(!gameActive) return;
        const en = document.createElement('div');
        en.className = 'enemy';
        en.innerHTML = 'ðŸ‘¾';
        const isLeft = Math.random() > 0.5;
        en.style.left = isLeft ? '-50px' : (window.innerWidth + 50) + 'px';
        en.style.top = (window.innerHeight / 2 - 25) + 'px';
        arena.appendChild(en);

        let pos = isLeft ? -50 : window.innerWidth + 50;
        const move = setInterval(() => {
            if(!gameActive) { clearInterval(move); en.remove(); return; }
            
            if(isLeft) pos += (3 + score/200); else pos -= (3 + score/200);
            en.style.left = pos + 'px';

            const pRect = player.getBoundingClientRect();
            if(Math.abs(pos - pRect.left) < 40) {
                hp -= 20;
                document.getElementById('hp').innerText = hp;
                document.getElementById('flash').style.opacity = '0.5';
                setTimeout(() => document.getElementById('flash').style.opacity = '0', 50);
                en.remove();
                clearInterval(move);
                if(hp <= 0) gameOver();
            }
        }, 20);

        setTimeout(spawnEnemy, Math.max(400, 1200 - score/5));
    }

    function gameOver() {
        gameActive = false;
        alert("ARENA OVERRUN!\nFinal Score: " + score);
        location.reload();
    }
</script>
</body>
</html>